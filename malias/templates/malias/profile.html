{% extends 'base.html' %}
{% load humanize %}
{% load static %}

{% block main %}
<div class="container">
    <div class="row">
        <div class="entry-header-area">
            <div class="row">
                <div class="col-md-12">
                    <div class="entry-header">
                        <h2 class="entry-title">My Account</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="checkout-area">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel-group" id="accordion">
                        <form action="{% url 'profile' %}" method="post">
                            {% csrf_token %}
                            <div class="panel panel_default">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a class="accordion-trigger" data-toggle="collapse" data-parent="#accordion"
                                           href="#payment-address">Personal Information<i class="fa fa-caret-down"></i>
                                        </a>
                                    </h4>
                                </div>
                                <div id="payment-address" class="collapse">
                                    <div class="panel-body">
                                        <div class="row">
                                            <div class="col-md-6 col-xs-12">
                                                <fieldset id="account">
                                                    <legend>Your Personal Details</legend>
                                                    <div class="form-group">
                                                        <label><sup>*</sup>First Name</label>
                                                        {{ user_form.first_name }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label><sup>*</sup>Last Name</label>
                                                        {{ user_form.last_name }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label><sup>*</sup>E-mail</label>
                                                        {{ user_form.username }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Old Password</label>
                                                        {{ user_form.old_password }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>New Password</label>
                                                        {{ user_form.new_password }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Confirm Password</label>
                                                        {{ user_form.confirm_password }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Phone number</label>
                                                        {{ customer_form.phone }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Country</label>
                                                        {{ customer_form.country }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>City</label>
                                                        {{ customer_form.city }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>District / County</label>
                                                        {{ customer_form.district }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Street</label>
                                                        {{ customer_form.street }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>House</label>
                                                        {{ customer_form.house }}
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Flat</label>
                                                        {{ customer_form.flat }}
                                                    </div>
                                                </fieldset>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-12">
                                                <div class="buttons clearfix">
                                                    <div class="pull-right">
                                                        {% include 'malias/components/_confirm_logout.html' %}
                                                        <button type="button"
                                                                class="btn btn-danger me-1"
                                                                data-toggle="modal"
                                                                data-target="#exampleModalLogout">
                                                            Logout
                                                        </button>
                                                        <button class="btn btn-primary" type="submit">Save</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <div class="panel panel_default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a class="accordion-trigger collapsed" data-toggle="collapse"
                                       data-parent="#accordion"
                                       href="#checkout-confirm">Order History<i
                                            class="fa fa-caret-down"></i> </a>
                                </h4>
                            </div>
                            <div id="checkout-confirm" class="collapse">
                                <h4 class="mt-3">Last Order â„–: {{ order.pk }}</h4>
                                <div class="panel-body">
                                    <!-- Start Table -->
                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead>
                                            <tr>
                                                <td class="text-center">Image</td>
                                                <td class="text-left">Product Name</td>
                                                <td class="text-left">Quantity</td>
                                                <td class="text-right">Price</td>
                                                <td class="text-right">Total price for this product</td>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            {% for product in order.products.all %}
                                            <tr>
                                                <td class="text-center">
                                                    <a href="{{ product.get_absolute_url }}"><img class="img-thumbnail"
                                                                                                  width="100"
                                                                                                  height="100"
                                                                                                  src="{{ product.photo }}"
                                                                                                  alt="img"></a>
                                                </td>
                                                <td class="text-left">
                                                    <a href="{{ product.get_absolute_url }}">{{ product.name }}</a>
                                                </td>
                                                <td class="text-left">{{ product.quantity }}</td>
                                                <td class="text-right">${{ product.price|intcomma }}</td>
                                                <td class="text-right">${{ product.total_price|intcomma }}</td>
                                            </tr>
                                            {% endfor %}
                                            </tbody>
                                            <tfoot>
                                            <tr>
                                                <td class="text-right" colspan="5">
                                                    <strong>Total Price:</strong>
                                                </td>
                                                <td class="text-right">${{ order.price|intcomma }}</td>
                                            </tr>
                                            <tr>
                                                <td class="text-right" colspan="5">
                                                    <strong>Date:</strong>
                                                </td>
                                                <td class="text-right">{{ order.created_at }}</td>
                                            </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                    <!-- End Table -->
                                    <div class="buttons pull-right">
                                        <a href="{% url 'orders' %}" class="btn btn-primary">See all orders</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock main %}
